<template>
  <div class="top-menu">
    <div class="phone-nav">
      <van-nav-bar
        title="标题"
        left-text="logo"
        right-text="按钮"
        :fixed="true"
        :z-index="99"
        @click-left="onClickLeft"
        @click-right="onClickRight"
      >
        <div slot="left" class="left">
          <div class="logo">
            <img src="../../assets/images/logo/logo.jpg" width="100%" height="100%" alt />
          </div>
        </div>
        <div slot="title" class="title">
          <div>
            <van-icon size="30px" :color="heartColor" name="like" @click="changeHeartColor" />
          </div>
        </div>
        <div slot="right" class="right">
          <div class="menu">
            <transition name="fade">
              <span v-show="!isOpen" @click="hideSticky" class="icon iconfont">&#xeb71;</span>
            </transition>
            <transition name="show">
              <van-icon
                v-show="isOpen"
                @click="showSticky"
                :key="2"
                name="cross"
                size="20px"
                color="rgba(0,0,0,0.6)"
              />
            </transition>
          </div>
        </div>
      </van-nav-bar>
    </div>
    <div class="pc-nav">暂无电脑端导航栏</div>
    <van-popup
      v-model="isOpen"
      position="right"
      :style="{ height: '100%', marginTop: '45px', width: '40%',zIndex:'9999999'}"
    >
      <van-list :v-model="false" :finished="true">
        <van-cell
          v-for="(item, index) in list"
          :key="index"
          :title="item.name"
          @click="navToPage(item)"
        >
          <van-icon size="20px" color="rgba(0,0,0,0.8)" :finished="true" :name="item.icon" />
        </van-cell>
      </van-list>
    </van-popup>
  </div>
</template>
<script>
import { mapState } from 'vuex';
export default {
  components: {},
  props: {},
  data () {
    return {
      isOpen: false,
      heartColor: 'rgba(0,0,0,0.4)',
      list: [
        {
          path: '/',
          icon: 'wap-home-o',
          name: '首页'
        },
        {
          path: 'recruitment',
          icon: 'label-o',
          name: '招生事项'
        },
        {
          path: 'recruitment',
          icon: 'manager-o',
          name: '师资'
        },
        {
          path: 'recruitment',
          icon: 'cluster-o',
          name: '环境'
        },
        {
          path: 'works',
          icon: 'photo-o',
          name: '学生作品'
        },
        {
          path: 'position',
          icon: 'location-o',
          name: '地点'
        },
        {
          path: 'contact',
          icon: 'phone-circle-o',
          name: '联系我们'
        }
      ],
      loading: false,
      finished: true
    };
  },
  computed: {
    ...mapState(['isPhone']) // 加载设备类型
  },
  created () {
    if (process.client) {
      this.heartColor = localStorage.getItem('heartColor')
        ? localStorage.getItem('heartColor')
        : 'rgba(0,0,0,0.4)';
    }
  },
  mounted () { },

  methods: {
    /**
     * @method 导航到具体页面
     * @param {listItem}
     * @return void
     */
    navToPage (item) {
      this.$router.push({ path: item.path });
      this.isOpen = false;
    },
    onLoad () {
      // 异步更新数据
      // 加载状态结束
      this.loading = true;
      this.finished = true;
      // 数据全部加载完成
    },
    onClickLeft () {
      this.$toast('返回');
    },
    onClickRight () {
      this.isOpen = !this.isOpen;
    },
    changeHeartColor () {
      if (this.heartColor === 'red') {
        this.$toast('谢谢你再次喜欢我!');
      } else {
        this.$toast('谢谢你喜欢我!');
        localStorage.setItem('heartColor', '#cf2729');
        this.heartColor = '#cf2729';
      }
    },
    hideSticky () {
      this.$emit('menu-open')
    },
    showSticky () {
      this.$emit('menu-close')
    }
  }
};
</script>
<style scoped lang="less">
.fade-enter-active,
.fade-leave-active {
  transition: all 0.2s;
  display: none;
}
.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {
  opacity: 0;
}
.show-enter-active,
.show-leave-active {
  transition: all 0.2s;
  display: none;
}
.show-enter, .show-leave-to /* .fade-leave-active below version 2.1.8 */ {
  opacity: 1;
}
.left {
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  justify-content: flex-start;
}
.logo {
  width: 100px;
  height: auto;
  z-index: 999;
}
.menu,
.icon {
  font-size: 26px;
}
.phone-nav {
  display: none;
}
.pc-nav {
  display: block;
  z-index: 999;
}

@media screen and(max-width: 720px) {
  .pc-nav {
    display: none;
  }
  .phone-nav {
    display: block;
    position: relative;
    z-index: 9999;
  }
}
</style>
